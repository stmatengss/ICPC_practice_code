////////////////////System Comment////////////////////
////Welcome to Hangzhou Dianzi University Online Judge
////http://acm.hdu.edu.cn
//////////////////////////////////////////////////////
////Username: stmatengss
////Nickname: Stmatengss
////Run ID: 
////Submit time: 2015-10-07 21:04:43
////Compiler: GUN C++
//////////////////////////////////////////////////////
////Problem ID: 2665
////Problem Title: 
////Run result: Accept
////Run time:748MS
////Run memory:26620KB
//////////////////System Comment End//////////////////
/*
&#214;¡Â&#207;¡¥¨º¡Â¡êo&#182;&#212;¨®¨²D¨°¨¢D¦Ì&#196;&#195;&#191;¨°&#187;&#184;&#246;&#199;¡ã¡Áo&#189;¡§¨°&#187;&#191;&#195;¨°&#212;D¨°¨¢D¨¤&#239;¦Ì&#196;&#214;¦Ì&#206;a&#207;&#194;¡À¨º¦Ì&#196;&#207;&#223;&#182;&#206;¨º¡Â¡ê¡§&#203;¨´¨°&#212;¨°a&#207;¨¨¨¤&#235;¨¦¡é&#187;¡¥¡ê&#169;¡ê&#172;
&#188;&#199;&#194;&#188;&#184;&#195;&#199;¡ã¡ÁoD¨°¨¢D¨¤&#239;3&#246;&#207;&#214;¦Ì&#196;&#214;¦Ì¦Ì&#196;¡ä&#206;¨ºy¡ê&#187;
&#188;&#199;¨¤&#235;¨¦¡éo¨®¦Ì&#196;¡À¨º&#188;&#199;&#206;a1~n; ¡ê¡§&#207;&#194;&#195;&#230;&#214;¦Ì&#214;¡À&#189;¨®¨®&#195;1~n¡ä¨²¨¬&#230;;¡ê&#169;
&#182;&#212;¨®¨²&#199;&#248;&#188;&#228;[x,y]¦Ì&#196;¦Ì¨²k¡ä¨®¦Ì&#196;&#214;¦Ì¡ê&#172;&#196;&#199;&#195;¡ä¡ä¨®root[x-1],root[y]&#191;a¨º&#188;¡ê&#172;
t=root[y].[1,mid]-root[x-1].[1,mid] ,t¡À¨ª¨º&#190;&#199;&#248;&#188;&#228;[x,y]&#196;¨²&#214;¦Ì&#212;¨²[1,mid]¦Ì&#196;&#184;&#246;¨ºy
&#207;¨¨&#197;D&#182;&#207;t¨º&#199;¡¤&#241;¡ä¨®¨®¨²K¡ê&#172;¨¨&#231;1&#251;t¡ä¨®¨®¨²k,&#196;&#199;&#195;¡ä&#203;¦Ì&#195;¡Â&#212;¨²&#199;&#248;&#188;&#228;[x,y]&#196;¨²¡ä&#230;&#212;¨²[1,mid]¦Ì&#196;¨ºy¦Ì&#196;&#184;&#246;¨ºy¡ä¨®¨®¨²k,
¨°2&#190;¨ª¨º&#199;¦Ì¨²k¡ä¨®¦Ì&#196;&#214;¦Ì&#212;¨²[1,mid]&#214;D¡ê&#172;¡¤&#241;&#212;¨°&#212;¨²[mid+1,r]&#214;D¡ê&#187;

&#213;a&#209;¨´&#206;¨°&#195;&#199;¨°¨¤¡ä&#206;¨ª&#172;¨º¡À¡ä¨®root[x-1],root[y]¨ª¨´&#207;&#194;¡Á&#223;
¦Ì¡Àl==r¨º¡À ¦Ì¨²k¡ä¨®¦Ì&#196;&#214;¦Ì&#190;¨ª¨º&#199;¨¤&#235;¨¦¡éo¨®¡À¨º&#188;&#199;&#206;al¦Ì&#196;&#214;¦Ì¡ê&#187;

¨¨&#231;1&#251;&#195;&#191;&#191;&#195;&#207;&#223;&#182;&#206;&#182;&#188;&#189;¡§¨ª¨º&#213;&#251;¦Ì&#196;&#187;¡¥¡ê&#172;n*(n<<2)&#191;&#207;&#182;¡§&#187;¨¢mle¡ê&#172;
&#206;¨°&#195;&#199;¡¤¡é&#207;&#214;&#182;&#212;¨®¨²&#199;¡ã¡Áo[1,i]o¨ª&#199;¡ã¡Áo[1,i+1]¦Ì&#196;&#207;&#223;&#182;&#206;¨º¡Â¡ê&#172;¨¨&#231;1&#251;b[i+1]<=mid (b[i+1]¡À¨ª¨º&#190;a[i+1]¨¤&#235;¨¦¡éo¨®¦Ì&#196;¡À¨º&#188;&#199;)
&#196;&#199;&#195;¡ä&#207;&#223;&#182;&#206;¨º¡Âio¨ª&#207;&#223;&#182;&#206;¨º¡Âi+1¦Ì&#196;¡Á¨®¡À&#223;¨º&#199;¨ª¨º¨¨&#171;&#207;¨¤¨ª&#172;¦Ì&#196;¡ê&#172;&#184;¨´¡À&#190;2&#187;D¨¨¨°a&#212;¨²&#189;¡§¡ê&#172;&#214;&#187;D¨¨¨°a¨®&#195;&#214;&#184;&#213;&#235;&#214;&#184;¨°&#187;&#207;&#194;&#190;¨ªo&#195;¡ê&#187;
&#196;&#199;&#195;¡ä&#182;&#212;¨®¨²¨°&#187;&#191;&#195;D&#194;¦Ì&#196;&#207;&#223;&#182;&#206;¨º¡Â&#198;&#228;¨º¦Ì&#206;¨°&#195;&#199;¡Á&#238;&#182;¨¤¨°a&#189;¡§¦Ì&#196;&#189;¨²¦Ì&#227;¨ºy&#206;alog(n)¡ê&#187;nlog(n)¦Ì&#196;&#189;¨²¦Ì&#227;¨ºy&#187;1¨º&#199;&#191;¨¦¨°&#212;¨¨¨¬¨º¨¹¦Ì&#196;¡ê&#187;



*/
#include<cstdio>
#include<cstring>
#include<iostream>
#include<algorithm>
#include<cmath>
#include<cstdlib>
#define w(i) T[(i)].w
#define ls(i) T[(i)].ls
#define rs(i) T[(i)].rs
using namespace std;
const int N=100000+10;
struct node{
    int ls,rs,w;
    node(){ls=rs=w=0;}
}T[N*20];
int a[N],b[N],p[N],root[N],sz;
int cmp(int i,int j){
    return a[i]<a[j];
}
int n,m;
void ins(int &i,int l,int r,int x){
    T[++sz]=T[i]; i=sz;
    w(i)++;
    if (l==r) return;
    int m=(l+r)>>1;
    if (x<=m) ins(ls(i),l,m,x);
    else ins(rs(i),m+1,r,x);
}
int query(int i,int j,int l,int r,int k){
    if (l==r) return l;
    int t=w(ls(j))-w(ls(i));
    int m=(l+r)>>1;
    if (t>=k) return query(ls(i),ls(j),l,m,k);
    else return query(rs(i),rs(j),m+1,r,k-t);
}
int main(){
    int Cas;scanf("%d",&Cas);
    while (Cas--){
        root[0]=0;
        scanf("%d%d",&n,&m);
        for (int i=1;i<=n;i++){
            scanf("%d",&a[i]);p[i]=i;
        }
        sort(p+1,p+1+n,cmp);//&#188;&#228;&#189;¨®&#197;&#197;D¨°¡ê&#172;p[i]¡À¨ª¨º&#190;¦Ì¨²iD&#161;¦Ì&#196;&#214;¦Ì&#212;¨²a[]&#214;D¦Ì&#196;&#207;&#194;¡À¨º¡ê&#187;
        for (int i=1;i<=n;i++) b[p[i]]=i;//¨¤&#235;¨¦¡é&#187;¡¥
        /*
        for (int i=1;i<=n;i++) cout<<a[i]<<" ";cout<<endl;
        for (int i=1;i<=n;i++) cout<<p[i]<<" ";cout<<endl;
        for (int i=1;i<=n;i++) cout<<b[i]<<" ";cout<<endl;
        */
        sz=0;
        for (int i=1;i<=n;i++){
            root[i]=root[i-1];
            ins(root[i],1,n,b[i]);
        }
        for (int i=0;i<m;i++){
            int x,y,k;scanf("%d%d%d",&x,&y,&k);
            int t=query(root[x-1],root[y],1,n,k);
            printf("%d\n",a[p[t]]);
        }
    }
    return 0;
}